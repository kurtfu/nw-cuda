# Needleman-Wunsch CUDA

C++/CUDA implementation of the Needleman-Wunsch global sequence alignment algorithm.

## Introduction

Needleman-Wunsch is an algorithm that is used to calculate similarities between two
amino-acid sequences. The algorithm was developed by Saul B. Needleman and
Christian D. Wunsch in 1970. The algorithm has $O(n^2)$ time and space complexity.
The time complexity can be reduced down to $O(n)$ with parallelization. This
project was designed to examine the effects of the parallellization techniques
and the performance of the parallel implementation.

The parallel implementation uses CUDA _Cooperative Groups_ for intra-block
synchronization. To run the project properly, Kepler or later
GPU(Compute Capability 3.0+) is required for the hardware side, and CUDA 9 or
later is required for the driver side. The host side uses modern features of
C++. At least C++11 supported compiler is required for building the project.

## How to Use

The project uses `CMake` as the build system and contains a pre-configured `CMake` rules.
The file is configured for both Windows and Unix-based systems.

To build the project, at the project root folder, run:

```
$ mkdir build
$ cd build
```
In the `build` folder, configure the build system and run the proper generator. For `Makefile`
generator run:

```
$ cmake ..
$ make
```

After the compilation, the project can be run for various input sequences and different
approach types by specifying program flags. The program options can be found by running
the program with the `--help` or `-h` flag. The following table shows the program options.

| Flag              | Description                    |
| ----------------- | ------------------------------ |
| `-h` `--help`     | Displays program description   |
| `-i` `--input`    | Specifies the input file       |
| `-o` `--output`   | Specifies the output file      |
| `-a` `--approach` | Specifies implementation type  |

The project was implemented for two approaches; the sequential approach with a
single CPU core, and the parallel approach for NVIDIA GPUs. The approach can be
specified at the program run with the `approach` flag. The table shows the possible
options.

| Approach | Description                        |
| -------- | ---------------------------------- |
| serial   | Sequential implementation with CPU |
| cuda     | Parallel implementation with GPU   |

## Examples

Sample input sequences can be found under the [input](input/) folder. More sample
sequences can be generated by running the [seqgen.py](tools/seqgen.py) script under
the [tools](tools/) folder.

To generate new sequences, run:

```
seqgen -l <length-of amino-acid sequences> -s <sample-count> -o <path-to-output-file>
```

Project examples can be found under the [examples](examples/) folder. [align.cpp](examples/align.cpp)
generates the traceback pattern and [score.cpp](examples/score.cpp) calculates the similarity score
between two sequences.

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## See Also

- [A general method applicable to the search for similarities in the amino acid sequence of two proteins](
https://pubmed.ncbi.nlm.nih.gov/5420325/)
